{{define "title"}}{{.PageContext.ShortName}} | Schedule | {{week (index .PageData.Schedule.Days 0)}}{{end}}
{{define "content"}}
{{with .PageData}}

<!-- top banner -->
<div class="container-fluid header-large current-next mobile-shrink">
  <div class="container">
      <div class="row justify-content-center">
        <div class="col-11 col-md-10 box-shadow-1 current-next-container mobile-hide">
          {{template "current_and_next" .}}
        </div>
        <div class="col-11 col-md-10 text-center mobile-only">
          <h1 class="display-3">Schedule</h1>
          <h2 class="display-5">{{week (index .Schedule.Days 0)}}</h2>
        </div>
      </div>
    </div>
</div>

<!-- schedule header -->
<div class="container-fluid bg-off-white">
  <div class="container justify-content-between py-3">
    <div class="row">
      <div class="col-auto">
        <h1 class="display-4 mobile-hide">Schedule <a class="fa fa-key schedule-key-icon" href="#key"></a></h1>
        <h2 class="text-muted mobile-hide">{{week (index .Schedule.Days 0)}}</h2>
      </div>
      <div class="col-12">
        <div class="row justify-content-center">
          {{with $weekName := week (index .Schedule.Days 0)}}
            {{if eq $weekName "this week"}}
              <button class="btn btn-secondary mobile-only inline" id="jumpToNow" type="button" onclick="jumpToNow()">Jump to the current show</button>
            {{end}}
          {{end}}
          <h1 class="mobile-only inline"><a class="fa fa-key schedule-key-icon" data-toggle="collapse" data-target=".schedule-keys" aria-expanded="false" aria-controls="schedule-keys"></a></h1>
        </div>
        <div class="schedule-keys collapse">
          <div class="key-row">
              {{ range .Subtypes }}
                <span class="schedule-block-{{.Class}}">{{.Name}}</span>
              {{end}}
          </div>
        </div>
      </div>
    </div>

    <nav aria-label="Related Schedules" class="row nav justify-content-between">
      {{if .PrevURL}}
        <a class="nav-link" href="{{url .PrevURL.Path}}">&larr; Previous week</a>
      {{end}}
      {{if .CurrURL}}
        <a class="nav-link" href="{{url .CurrURL.Path}}">Permalink</a>
      {{end}}
      {{if .NextURL}}
        <a class="nav-link" href="{{url .NextURL.Path}}">Next week &rarr;</a>
      {{end}}
    </nav>
  </div>
</div>

<!-- schedule body -->
<div class="container-fluid bg-off-white">
  <div class="container">
  {{if .Schedule}}
    {{with .Schedule}}
      <div class="schedule-container">
        {{ range .Days}}
          <h3>{{.Weekday}}&nbsp;{{.Format "02"}}</h3>
          <ol style="list-style-type: none">
            {{range (index $.PageData.Schedule.DayItems .)}}
              <li>
                <span>{{.Start.Hour | printf "%02d"}}:{{.Start.Minute | printf "%02d"}} - {{.Finish.Hour | printf "%02d"}}:{{.Finish.Minute | printf "%02d"}}</span>
                <div title="{{stripHTML .Desc}}"
                        {{if .PageURL}} onclick="window.location.href='{{url .PageURL}}'" {{end}} >
                  {{if .PageURL}}
                    <a href="{{url .PageURL}}" >{{.Name}}</a>
                  {{else}}
                    <p>{{.Name}}</p>
                  {{end}}
                </div>
              </li>
            {{end}}
          </ol>
        {{end}}
      </div>
    {{end}}
  {{else}}
    <div class="row justify-content-center p-5">
      <div class="col-12 col-lg-8 p-5 text-center schedule-block-regular disabled">
        <h3>There's nothing on for this week.</h3>
        <h4>We're most likely off air, or we haven't scheduled it yet!</h4>
      </div>
    </div>
  {{end}}
  {{end}}
  <br>
    <div class="row justify-content-center pb-3">
        <div class="schedule-keys" id="key">
          <div class="key-row">
            <h2 class="inline">Schedule Key:</h2>
            {{ range .PageData.Subtypes }}
              <span class="schedule-block-{{.Class}}">{{.Name}}</span>
            {{end}}
          </div>
        </div>
    </div>
  </div>
</div>
{{end}}
{{define "footer-scripts"}}
<!-- Jump to day button -->
<script>var StartHour = {{.PageData.StartHour}};</script>
<script src='{{url "/js/schedule.js"}}?ver={{ .PageContext.CacheBuster }}' id="jumpToNow"></script>
{{end}}
